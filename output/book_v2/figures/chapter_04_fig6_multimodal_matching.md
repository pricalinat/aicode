# 图4.6：多模态商品匹配模型

```
任务: 判断两个商品是否相同

商品A: "Apple iPhone 15 128GB 蓝色"
商品A图片: [iPhone15蓝色照片]

商品B: "iPhone 15 128G 蓝色 苹果手机"
商品B图片: [iPhone15蓝色照片2]

┌─────────────────────────────────────────────────────────────────────┐
│                    多模态商品匹配流程                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  Step 1: 文本编码                                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  TextA = BERT("Apple iPhone 15 128GB 蓝色")                │   │
│  │  TextB = BERT("iPhone 15 128G 蓝色 苹果手机")             │   │
│  │  t_sim = cosine(TextA, TextB) = 0.92                       │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  Step 2: 图像编码                                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  ImgA = CLIP_Image(ImageA)                                  │   │
│  │  ImgB = CLIP_Image(ImageB)                                  │   │
│  │  i_sim = cosine(ImgA, ImgB) = 0.95                        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  Step 3: 跨模态匹配                                                │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  跨模态A: TextA vs ImgA → 0.88                             │   │
│  │  跨模态B: TextA vs ImgB → 0.91                             │   │
│  │  跨模态C: TextB vs ImgA → 0.89                             │   │
│  │  跨模态D: TextB vs ImgB → 0.93                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  Step 4: 融合预测                                                  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  Feature = [t_sim, i_sim, cross_features...]               │   │
│  │                                                              │   │
│  │  MatchScore = MLP(Feature)                                 │   │
│  │                                                              │   │
│  │  预测结果: 0.94 > 0.5 → 匹配                              │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                      │
│  最终融合公式:                                                      │
│  Score = α × t_sim + β × i_sim + γ × cross_sim                    │
│          其中 α, β, γ 是可学习权重                                  │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```
