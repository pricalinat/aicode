# 图4.5：电商搜索系统架构

```
┌─────────────────────────────────────────────────────────────────────┐
│                      电商搜索系统架构                                │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  用户输入: "适合游戏的手机"                                          │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                    查询理解层                                │   │
│  │  • 意图识别: 游戏手机推荐                                   │   │
│  │  • 实体识别: 手机 (商品类目)                                │   │
│  │  • 扩展: 游戏手机→电竞手机→高性能手机                      │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                     召回层                                   │   │
│  │  • 向量召回: ANN检索Top-1000                                │   │
│  │  • 规则召回: 促销活动、新品                                  │   │
│  │  • 类目召回: 智能手机类目                                   │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                     粗排层                                   │   │
│  │  • 模型: 轻量级DNN                                          │   │
│  │  • 特征: 文本相似度、类目匹配、销量                         │   │
│  │  • 输出: Top-200                                            │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                     精排层                                   │   │
│  │  • 模型: DeepFM / DIEN / BST                               │   │
│  │  • 特征: 用户画像、商品特征、交叉特征                       │   │
│  │  • 输出: Top-50                                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                              ↓                                        │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                     重排层                                   │   │
│  │  • 多样性: MMR / DPP                                        │   │
│  │  • 新鲜度: 最近上架商品                                      │   │
│  │  • 业务规则: 促销活动优先                                   │   │
│  │  • 输出: 最终排序结果                                       │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```
